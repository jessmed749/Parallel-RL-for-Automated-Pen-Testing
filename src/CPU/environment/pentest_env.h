#include <array>
#include <random>

enum Action {
    SCAN_NEXT = 0,
    EXPLOIT_NEXT = 1,
    SCAN_PREV = 2,
    EXPLOIT_PREV = 3
};

class PentestEnv {
public:
    // Constructor
    PentestEnv(int seed);

    // Public methods
    void reset();
    int step(Action action);
    int get_observation_space_size() const;
    int get_action_space_size() const;
    bool is_episode_done() const;
    std::array<int, 5> get_observation() const;

    private:
    // Internal state variables
    int current_state;
    std::mt19937 rng;

    // Helper methods
    int get_current_node() const;
    void set_current_node(int node);
    bool is_node_compromised(int node) const;
    void set_node_compromised(int node);
    bool is_valid_action(Action action) const;
    double calculate_reward(Action action, bool success) const;
    
    
};